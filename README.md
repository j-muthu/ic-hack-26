# Kalm - AI Recovery Companion

A Telegram bot that provides 24/7 emotional support for people in addiction recovery. Users message the bot and receive personalized, empathetic voice notes generated by AI.

## Tech Stack

- **Backend**: Python FastAPI
- **AI Responses**: OpenAI GPT-4o-mini
- **Voice Generation**: ElevenLabs Text-to-Speech
- **Messaging**: Telegram Bot API
- **Frontend**: Next.js + Tailwind CSS

## Architecture

```
User sends Telegram message
         â†“
   "Recording voice message..."
         â†“
   GPT-4o-mini generates empathetic response
         â†“
   ElevenLabs converts to voice
         â†“
   Voice note sent to user
```

## Prerequisites

- Python 3.9+
- Node.js 18+
- API Keys:
  - [ElevenLabs](https://elevenlabs.io/) - for voice generation
  - [OpenAI](https://platform.openai.com/) - for AI responses
  - [Telegram Bot Token](https://t.me/BotFather) - for the bot

## Setup

### 1. Clone the repository

```bash
git clone <your-repo-url>
cd ic-hack-26
```

### 2. Create a Telegram Bot

1. Message [@BotFather](https://t.me/BotFather) on Telegram
2. Send `/newbot` and follow the prompts
3. Copy the bot token you receive

### 3. Backend Setup

```bash
cd backend

# Create virtual environment
python -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate

# Install dependencies
pip install -r requirements.txt

# Create environment file
cp .env.example .env
```

Edit `.env` with your API keys:

```
ELEVENLABS_API_KEY=your_elevenlabs_api_key
TELEGRAM_BOT_TOKEN=your_telegram_bot_token
OPENAI_API_KEY=your_openai_api_key
```

### 4. Frontend Setup

```bash
cd frontend

# Install dependencies
npm install

# Create environment file (optional, for API URL config)
cp .env.local.example .env.local
```

## Running Locally

### Start the Backend

```bash
cd backend
source venv/bin/activate  # On Windows: venv\Scripts\activate
uvicorn main:app --reload
```

You should see:
```
ðŸ”„ Clearing webhook for polling mode...
ðŸ¤– Starting Telegram bot polling...
```

### Start the Frontend

```bash
cd frontend
npm run dev
```

Frontend will be available at `http://localhost:3000`

## Testing the Bot

1. Open Telegram and search for your bot (the username you gave it)
2. Press **Start**
3. You should see "Recording voice message..." followed by a voice welcome
4. Send any message like "I'm feeling stressed" or "I'm having cravings"
5. The bot will respond with a personalized voice note

## Project Structure

```
ic-hack-26/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ main.py                 # FastAPI app, Telegram polling
â”‚   â”œâ”€â”€ requirements.txt
â”‚   â”œâ”€â”€ .env.example
â”‚   â””â”€â”€ services/
â”‚       â”œâ”€â”€ elevenlabs.py       # Text-to-speech
â”‚       â”œâ”€â”€ openai_service.py   # AI response generation
â”‚       â””â”€â”€ telegram_service.py # Telegram API wrapper
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ page.js             # Landing page
â”‚   â”‚   â”œâ”€â”€ layout.js
â”‚   â”‚   â””â”€â”€ globals.css
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ tailwind.config.js
â””â”€â”€ README.md
```

## Environment Variables

| Variable | Description |
|----------|-------------|
| `ELEVENLABS_API_KEY` | ElevenLabs API key for voice generation |
| `TELEGRAM_BOT_TOKEN` | Telegram bot token from BotFather |
| `OPENAI_API_KEY` | OpenAI API key for GPT-4o-mini |

## Troubleshooting

### Bot not responding?
- Check that your `TELEGRAM_BOT_TOKEN` is correct
- Ensure the backend is running and showing "Starting Telegram bot polling..."
- Check the terminal for error messages

### Voice notes not sending?
- Verify your `ELEVENLABS_API_KEY` is valid
- Check you have credits remaining in ElevenLabs

### AI responses not working?
- Verify your `OPENAI_API_KEY` is valid
- Check for errors in the terminal output

## Deploying to Vercel (Frontend)

The Next.js frontend can be deployed to Vercel for free.

### Steps

1. **Push your code to GitHub** (if not already done)
   ```bash
   git add .
   git commit -m "Ready for deployment"
   git push
   ```

2. **Go to [vercel.com](https://vercel.com)** and sign in with GitHub

3. **Click "Add New Project"** and import your repository

4. **Configure the project:**
   - **Root Directory**: Click "Edit" and set to `frontend`
   - **Framework Preset**: Next.js (should auto-detect)

5. **Click "Deploy"**

6. **Done!** Your frontend will be live at `https://your-project.vercel.app`

### Custom Domain (Optional)

1. Go to your project settings on Vercel
2. Click "Domains"
3. Add your custom domain and follow DNS instructions

### Notes

- The frontend is static and doesn't require environment variables
- The Telegram bot link is hardcoded to `@kalm_ai_bot`
- Backend must be deployed separately (e.g., Railway, Render, or a VPS)
